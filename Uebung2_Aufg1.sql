SELECT *, amount 
FROM ( 
	SELECT *, (SUM(HAUS_BETRAG * (-1)) OVER(ORDER BY BUCHUNGSDATUM DESC, BELEGNUMMER DESC) - (HAUS_BETRAG * -1)) AS AMOUNT 
	FROM SAPQ92.ACDOCA_HPI 
	WHERE KUNDE = 'C0027' AND BUCHUNGSDATUM <= 20140602 AND KONTO = 0000792000
) 
WHERE AMOUNT < ( 
	SELECT SUM(HAUS_BETRAG) as amount 
	FROM SAPQ92.ACDOCA_HPI 
	WHERE KUNDE = 'C0027' AND BUCHUNGSDATUM <= 20140602 AND KONTO IN (0000792000, 0000893015) 
)